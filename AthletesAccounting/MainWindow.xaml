<Window x:Class="AthletesAccounting.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AthletesAccounting"            
        mc:Ignorable="d"
        Title="Карта пациента"  VerticalAlignment="Center" HorizontalAlignment="Center"
        Loaded="Window_Loaded" Height="857" Width="839"
        >
    
    <Grid x:Name="gridAll" Margin="10,10,10,10" FocusManager.FocusedElement="{Binding ElementName=comboBox}">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <GroupBox Grid.Row="0" Margin="10,35,10,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"></ColumnDefinition>
                    <ColumnDefinition Width="auto"></ColumnDefinition>
                    <ColumnDefinition Width="auto"></ColumnDefinition>
                    <ColumnDefinition Width="auto"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Label Content="Поиск" Grid.Column="0" VerticalAlignment="Center" Margin="10,10,10,10"/>

                <Button x:Name="Btn_Grid_Update" Grid.Column="2" VerticalAlignment="Center" Margin="10,10,10,10" HorizontalAlignment="Left" 
                                    Width="auto" Padding="5,5,5,5" Click="Btn_Grid_Update_Click" >Сбросить</Button>
                <ComboBox x:Name="comboBox" Grid.Column="1" HorizontalAlignment="Left"  VerticalAlignment="Center" Width="350" Height="auto" IsEditable="True"
                          PreviewTextInput="comboBox_PreviewTextInput"  ToolTip="Введите первые 3 буквы фамилии"   Padding="5,5,5,5"  SelectionChanged="comboBox_SelectionChanged"
                        SelectedValuePath="id"  >

                    <!--<ComboBox.Text>
                        <MultiBinding StringFormat="{}{0} {1} {2} {3:dd.MM.yyyy}">
                            <Binding Path="fam"/>
                            <Binding Path="name"/>
                            <Binding Path="parent"/>
                            <Binding Path="DOB"/>
                        </MultiBinding>
                    </ComboBox.Text>-->

                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock>
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0} {1} {2} {3:dd.MM.yyyy}">
                                        <Binding Path="fam"/>
                                        <Binding Path="name"/>
                                        <Binding Path="parent"/>
                                        <Binding Path="DOB"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

            </Grid>
        </GroupBox>
        <GroupBox Grid.Row="1" Margin="10,10,10,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                </Grid.RowDefinitions>
                <Expander x:Name="PersonalData" VerticalAlignment="Center" Header="Персональные данные" Grid.Row="1" IsExpanded="True">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                            <RowDefinition Height="auto"></RowDefinition>
                        </Grid.RowDefinitions>
                       
                        <Label Content="Фамилия" Grid.Row="0" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                        <TextBox x:Name="Fam" Grid.Column="1"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="0" Width="100">
                            <TextBox.Text>
                                <Binding Path="fam"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Имя" Grid.Row="0" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        <TextBox x:Name="Name" Grid.Column="3" VerticalAlignment="Stretch" HorizontalAlignment="Left" Grid.Row="0" Width="100">
                            <TextBox.Text>
                                <Binding Path="name"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Отчество" Grid.Row="0" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="Parent" Grid.Column="5" VerticalAlignment="Stretch" HorizontalAlignment="Left" Grid.Row="0" Width="100">
                            <TextBox.Text>
                                <Binding Path="parent"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Пол" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        <ComboBox x:Name="sex" Grid.Column="3" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="1" Width="100">
                            <ComboBox.Text>
                                <Binding Path="sex"></Binding>
                            </ComboBox.Text>
                            <ComboBoxItem>Муж.</ComboBoxItem>
                            <ComboBoxItem>Жен.</ComboBoxItem>
                        </ComboBox>

                        <Label Content="Дата Рождения" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <!--<TextBox x:Name="DOB" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="4" Width="100"/>-->
                        <DatePicker x:Name="DOB" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" Width="100" SelectedDateChanged="DOB_SelectedDateChanged">
                            <DatePicker.SelectedDate>
                                <Binding Path="DOB"></Binding>
                            </DatePicker.SelectedDate>
                        </DatePicker>

                        <Label Content="Домашний адрес" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                        <TextBox x:Name="Adres" Grid.Column="1" VerticalAlignment="Stretch" Grid.Row="2" HorizontalAlignment="Stretch" Grid.ColumnSpan="3">
                            <TextBox.Text>
                                <Binding Path="adress"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Телефон" Grid.Row="2" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="Telefon" Grid.Column="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="2" Width="100" >
                            <TextBox.Text>
                                <Binding Path="telefon"></Binding>
                            </TextBox.Text>
                        </TextBox>                      

                        <Label Content="Вид спорта" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="Sport" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="3" Width="100"/>


                        <Label Content="Спортколлектив (ДЮСШ)" Grid.Row="3" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="orgNameAthlet" Grid.Column="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                                  Grid.Row="3" IsEditable="True" Grid.ColumnSpan="3" />

                        <Label Content="Место учебы/работы/ДУ" Grid.Row="7" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="PlaceStydy" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Left" Grid.Row="7" Width="100">
                            <TextBox.Text>
                                <Binding Path="placeStudy"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Профессия, Должность" Grid.Row="7" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="profAthlets" Grid.Column="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="7" Width="100" >
                            <TextBox.Text>
                                <Binding Path="profAthlets"></Binding>
                            </TextBox.Text>
                        </TextBox>

                        <Label Content="Образование" Grid.Row="7" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="education" Grid.Column="5" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="7" Width="100" >
                            <ComboBox.Text>
                                <Binding Path="education"></Binding>
                            </ComboBox.Text>
                        </ComboBox>


                        <Label Content="Употребление алкоголя" Grid.Row="8" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="alcohol" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="8" Width="100" >
                            <ComboBoxItem>Случайное</ComboBoxItem>
                            <ComboBoxItem>Мало</ComboBoxItem>
                            <ComboBoxItem>Много</ComboBoxItem>
                            <ComboBoxItem>Часто</ComboBoxItem>
                            <ComboBoxItem>Не употребляет</ComboBoxItem>
                        </ComboBox>


                        <Label Content="Жилищные условия" Grid.Row="8" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="livingСonditions" Grid.Column="3" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="8" Width="100" >
                            <ComboBoxItem>Удолетворительно</ComboBoxItem>
                            <ComboBoxItem>НЕ удолетворительно</ComboBoxItem>
                            <ComboBox.Text>Удолетворительно</ComboBox.Text>
                        </ComboBox>

                        <Label Content="Курение" Grid.Row="8" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="smoking" Grid.Column="5" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="8" Width="100" >
                            <ComboBoxItem>Не курит</ComboBoxItem>
                            <ComboBoxItem>Курит</ComboBoxItem>
                        </ComboBox>

                        <Label Content="Перенесенные заболевания" Grid.Row="9" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="PastIllnesses" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="9" Grid.ColumnSpan="2"
                                 TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True" ToolTip="перечисление заболеваний через нажатие ENTER"/>

                        <Label Content="Операции" Grid.Row="10" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="Operations" Grid.Column="1" VerticalAlignment="Stretch" Grid.Row="10" Grid.ColumnSpan="2"
                                 TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True" ToolTip="перечисление операций через нажатие ENTER"/>

                        <Label Content="Травмы" Grid.Row="10" Grid.Column="3" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox x:Name="Injury" Grid.Column="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="10" Grid.ColumnSpan="2"
                                 TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True" ToolTip="перечисление травм через нажатие ENTER"/>


                        <Label Content="Разряд" Grid.Row="11" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <ComboBox x:Name="Rank" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="11" Width="100"/>

                        <Label Content="Каким пре-нно занимается?" ToolTip="Каким видом спорта преимущественно занимается?" Grid.Row="12"
                               Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.ColumnSpan="2"/>
                        <ComboBox x:Name="mainSport" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Stretch" Grid.Row="12" ToolTip="Вид спорта"/>
                        <Label Content="Сколько времени?" Grid.Row="12" Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.ColumnSpan="2"/>
                        <!--<Label Content="C" Grid.Row="13" Grid.Column="4" HorizontalAlignment="Right" VerticalAlignment="Center"/>-->
                        <DatePicker Grid.Row="12" Grid.Column="3" VerticalAlignment="Stretch" HorizontalAlignment="Right" ToolTip="укажите дату начала"/>

                        <Label Content="Какими др. видами занимался?" Grid.Row="13" Grid.Column="0" HorizontalAlignment="Left"
                               VerticalAlignment="Center" ToolTip="Какими другими видами спорта занимался "/>
                        <ComboBox x:Name="cmbotherSports" Grid.Row="13" Grid.Column="1" ToolTip="Вид спорта"/>
                        <TextBox Name="txtotherSports" Grid.Row="13" Grid.Column="2" IsReadOnly="False"  />
                        <Button Grid.Column="3" Grid.Row="13" ToolTip="добавить вид спорта">Добавить</Button>

                        <Label Content="По каким участвовал?" ToolTip="По каким видам спорта участвовал в соревнованиях?" Grid.Row="14" Grid.Column="0"></Label>
                        <ComboBox Grid.Row="14" Grid.Column="1" ToolTip="Вид спорта" Height="26" VerticalAlignment="Top"/>
                        <TextBox Grid.Row="14" Grid.Column="2" IsReadOnly="False"></TextBox>
                        <Button Grid.Row="14" Grid.Column="3" >Добавить</Button>

                        <Label Content="Разряд дата получения" ToolTip="дата получения каждого разряда" Grid.Row="15" Grid.Column="0"></Label>
                        <ComboBox x:Name="rancDate" Grid.Row="15" Grid.Column="1" ToolTip="Разряд"/>
                        <DatePicker Grid.Row="15" Grid.Column="3" />
                        <TextBox Grid.Row="15" Grid.Column="4" ToolTip="Перечень видов спорта" IsReadOnly="False" VerticalScrollBarVisibility="Auto" />
                        <Button Grid.Column="5" Grid.Row="15" ToolTip="добавить дату получения разряда">Добавить</Button>
                        <ComboBox ToolTip="Вид спрота" Grid.Row="15" Grid.Column="2"/>

                    </Grid>
                </Expander>
            </Grid>
        </GroupBox>
        <GroupBox x:Name="groupBox" Margin="10,10,10,10" Grid.Row="2" VerticalAlignment="Top" Width="auto">

            <Expander Header="Антрометрия" VerticalAlignment="Center" HorizontalAlignment="Stretch" IsExpanded="True">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition Height="auto"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Label Content="Возраст" Grid.Row="0" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                    <TextBox x:Name="txtbAge" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="0" Width="100" IsReadOnly="True"/>

                    <Label Content="Рост" Grid.Row="0" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="txtbHeightAthletes" Grid.Column="5"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="0" Width="100"/>

                    <Label Content="Вес" Grid.Row="0" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="Weight" Grid.Column="3"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="0" Width="100"/>

                    <Label Content="Спирометрия" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="Spirometry" Grid.Column="1"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="3" Width="100"/>

                    <Label Content="Обр. гр. кл. выдох" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="Exhalation" Grid.Column="1"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="1" Width="100"/>

                    <Label Content="Обр. гр. кл. вдох" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="Breath" Grid.Column="3"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="1" Width="100"/>

                    <Label Content="Обр. гр. кл. пауза" Grid.Row="1" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="BreathPause" Grid.Column="5"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="1" Width="100"/>

                    <Label Content="Становая" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="Stanomy" Grid.Column="1"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="2" Width="100"/>

                    <Label Content="Динанометрия пр." Grid.Row="2" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="DynamometryR" Grid.Column="3"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="2" Width="100"/>

                    <Label Content="Динанометрия лв." Grid.Row="2" Grid.Column="4" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <TextBox x:Name="DynamometryL" Grid.Column="5"  VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="2" Width="100"/>

                </Grid>
            </Expander>
        </GroupBox>
        <GroupBox Margin="10,10,10,10" Grid.Row="3" VerticalAlignment="Top">
            <Expander Header="Врач спортивной медицины" HorizontalAlignment="Stretch">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"></RowDefinition>
                        <!--<RowDefinition Height="auto"></RowDefinition>-->
                    </Grid.RowDefinitions>


                    <DatePicker Grid.Row="0" Grid.Column="0" HorizontalAlignment="Left" Width="103" Margin="5,5,5,5"/>
                    <TextBox Grid.Column="1" HorizontalAlignment="Stretch" MinWidth="500" MaxHeight="{Binding Ele}" MaxLines="10" TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Visible" AcceptsReturn="True"/>

                </Grid>
            </Expander>
        </GroupBox>

        <Menu Height="25" VerticalAlignment="Top">
            <MenuItem Header="Файл">
                <MenuItem Header="Экспорт БД в excel" Click="exportExcel"></MenuItem>
                <MenuItem Header="Ипорт БД из excel" Click="importExcel"/>
                <!--<MenuItem Header="WinForms"></MenuItem>
                    <MenuItem Header="WPF" ></MenuItem>-->
                <Separator />
                <MenuItem Header="Выход" ></MenuItem>
            </MenuItem>
            <MenuItem Header="Редактировать" >
                <MenuItem Header="Справочники">
                    <MenuItem Header="Виды спорта" Click="MenuItem_Click"></MenuItem>
                    <MenuItem Header="Перенесенные заболевания" Click="MenuItem_Click"></MenuItem>
                    <MenuItem Header="Операции" Click="MenuItem_Click"></MenuItem>
                    <MenuItem Header="Спортколлектив (ДЮСШ)" Click="MenuItem_Click"></MenuItem>
                    <MenuItem Header="Образование" Click="MenuItem_Click"></MenuItem>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Настройки" ></MenuItem>
        </Menu>
    </Grid>

   
</Window>
